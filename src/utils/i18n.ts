export type Language = "en" | "es" | "fr" | "de" | "it" | "pt" | "zh" | "ja";

export interface Translations {
  [key: string]: string;
}

export interface LanguageConfig {
  current: Language;
  fallback: Language;
}

const translations: Record<Language, Translations> = {
  en: {
    "app.title": "Polymarket Bloomberg TUI",
    "nav.markets": "Markets",
    "nav.portfolio": "Portfolio",
    "nav.orders": "Orders",
    "panel.wallet": "Wallet",
    "panel.order": "Order",
    "panel.history": "History",
    "panel.alerts": "Alerts",
    "panel.analytics": "Analytics",
    "panel.settings": "Settings",
    "panel.shortcuts": "Shortcuts",
    "panel.assistant": "AI Assistant",
    "status.connected": "Connected",
    "status.disconnected": "Disconnected",
    "status.connecting": "Connecting...",
    "action.buy": "Buy",
    "action.sell": "Sell",
    "action.cancel": "Cancel",
    "action.confirm": "Confirm",
    "action.refresh": "Refresh",
    "action.save": "Save",
    "action.close": "Close",
    "action.search": "Search",
    "table.volume": "Volume",
    "table.price": "Price",
    "table.change": "Change",
    "table.outcome": "Outcome",
    "table.size": "Size",
    "table.value": "Value",
    "table.pnl": "P&L",
    "error.generic": "An error occurred",
    "error.network": "Network error",
    "error.auth": "Authentication error",
    "success.saved": "Saved successfully",
    "success.order": "Order placed",
    "confirm.cancel": "Are you sure?",
    "time.now": "Just now",
    "time.minutes": "{n} minutes ago",
    "time.hours": "{n} hours ago",
    "time.days": "{n} days ago",
  },
  es: {
    "app.title": "Polymarket Bloomberg TUI",
    "nav.markets": "Mercados",
    "nav.portfolio": "Portafolio",
    "nav.orders": "Órdenes",
    "panel.wallet": "Billetera",
    "panel.order": "Orden",
    "panel.history": "Historial",
    "panel.alerts": "Alertas",
    "panel.analytics": "Analítica",
    "panel.settings": "Ajustes",
    "panel.shortcuts": "Atajos",
    "panel.assistant": "Asistente IA",
    "status.connected": "Conectado",
    "status.disconnected": "Desconectado",
    "status.connecting": "Conectando...",
    "action.buy": "Comprar",
    "action.sell": "Vender",
    "action.cancel": "Cancelar",
    "action.confirm": "Confirmar",
    "action.refresh": "Actualizar",
    "action.save": "Guardar",
    "action.close": "Cerrar",
    "action.search": "Buscar",
    "table.volume": "Volumen",
    "table.price": "Precio",
    "table.change": "Cambio",
    "table.outcome": "Resultado",
    "table.size": "Tamaño",
    "table.value": "Valor",
    "table.pnl": "G/P",
    "error.generic": "Ocurrió un error",
    "error.network": "Error de red",
    "error.auth": "Error de autenticación",
    "success.saved": "Guardado exitosamente",
    "success.order": "Orden colocada",
    "confirm.cancel": "¿Estás seguro?",
    "time.now": "Ahora",
    "time.minutes": "hace {n} minutos",
    "time.hours": "hace {n} horas",
    "time.days": "hace {n} días",
  },
  fr: {
    "app.title": "Polymarket Bloomberg TUI",
    "nav.markets": "Marchés",
    "nav.portfolio": "Portefeuille",
    "nav.orders": "Ordres",
    "panel.wallet": "Portefeuille",
    "panel.order": "Ordre",
    "panel.history": "Historique",
    "panel.alerts": "Alertes",
    "panel.analytics": "Analytique",
    "panel.settings": "Paramètres",
    "panel.shortcuts": "Raccourcis",
    "panel.assistant": "Assistant IA",
    "status.connected": "Connecté",
    "status.disconnected": "Déconnecté",
    "status.connecting": "Connexion...",
    "action.buy": "Acheter",
    "action.sell": "Vendre",
    "action.cancel": "Annuler",
    "action.confirm": "Confirmer",
    "action.refresh": "Actualiser",
    "action.save": "Sauvegarder",
    "action.close": "Fermer",
    "action.search": "Rechercher",
    "table.volume": "Volume",
    "table.price": "Prix",
    "table.change": "Variation",
    "table.outcome": "Résultat",
    "table.size": "Taille",
    "table.value": "Valeur",
    "table.pnl": "P&P",
    "error.generic": "Une erreur est survenue",
    "error.network": "Erreur réseau",
    "error.auth": "Erreur d'authentification",
    "success.saved": "Sauvegardé",
    "success.order": "Ordre passé",
    "confirm.cancel": "Êtes-vous sûr?",
    "time.now": "Maintenant",
    "time.minutes": "il y a {n} minutes",
    "time.hours": "il y a {n} heures",
    "time.days": "il y a {n} jours",
  },
  de: {
    "app.title": "Polymarket Bloomberg TUI",
    "nav.markets": "Märkte",
    "nav.portfolio": "Portfolio",
    "nav.orders": "Aufträge",
    "panel.wallet": "Wallet",
    "panel.order": "Auftrag",
    "panel.history": "Verlauf",
    "panel.alerts": "Alarme",
    "panel.analytics": "Analytik",
    "panel.settings": "Einstellungen",
    "panel.shortcuts": "Tastenkürzel",
    "panel.assistant": "KI-Assistent",
    "status.connected": "Verbunden",
    "status.disconnected": "Getrennt",
    "status.connecting": "Verbinde...",
    "action.buy": "Kaufen",
    "action.sell": "Verkaufen",
    "action.cancel": "Abbrechen",
    "action.confirm": "Bestätigen",
    "action.refresh": "Aktualisieren",
    "action.save": "Speichern",
    "action.close": "Schließen",
    "action.search": "Suchen",
    "table.volume": "Volumen",
    "table.price": "Preis",
    "table.change": "Änderung",
    "table.outcome": "Ergebnis",
    "table.size": "Größe",
    "table.value": "Wert",
    "table.pnl": "G/V",
    "error.generic": "Ein Fehler ist aufgetreten",
    "error.network": "Netzwerkfehler",
    "error.auth": "Authentifizierungsfehler",
    "success.saved": "Erfolgreich gespeichert",
    "success.order": "Auftrag platziert",
    "confirm.cancel": "Sind Sie sicher?",
    "time.now": "Jetzt",
    "time.minutes": "vor {n} Minuten",
    "time.hours": "vor {n} Stunden",
    "time.days": "vor {n} Tagen",
  },
  it: {
    "app.title": "Polymarket Bloomberg TUI",
    "nav.markets": "Mercati",
    "nav.portfolio": "Portafoglio",
    "nav.orders": "Ordini",
    "panel.wallet": "Portafoglio",
    "panel.order": "Ordine",
    "panel.history": "Storico",
    "panel.alerts": "Allarmi",
    "panel.analytics": "Analitica",
    "panel.settings": "Impostazioni",
    "panel.shortcuts": "Scorciatoie",
    "panel.assistant": "Assistente IA",
    "status.connected": "Connesso",
    "status.disconnected": "Disconnesso",
    "status.connecting": "Connessione...",
    "action.buy": "Compra",
    "action.sell": "Vendi",
    "action.cancel": "Annulla",
    "action.confirm": "Conferma",
    "action.refresh": "Aggiorna",
    "action.save": "Salva",
    "action.close": "Chiudi",
    "action.search": "Cerca",
    "table.volume": "Volume",
    "table.price": "Prezzo",
    "table.change": "Variazione",
    "table.outcome": "Risultato",
    "table.size": "Dimensione",
    "table.value": "Valore",
    "table.pnl": "P&L",
    "error.generic": "Si è verificato un errore",
    "error.network": "Errore di rete",
    "error.auth": "Errore di autenticazione",
    "success.saved": "Salvato con successo",
    "success.order": "Ordine effettuato",
    "confirm.cancel": "Sei sicuro?",
    "time.now": "Adesso",
    "time.minutes": "{n} minuti fa",
    "time.hours": "{n} ore fa",
    "time.days": "{n} giorni fa",
  },
  pt: {
    "app.title": "Polymarket Bloomberg TUI",
    "nav.markets": "Mercados",
    "nav.portfolio": "Portfólio",
    "nav.orders": "Ordens",
    "panel.wallet": "Carteira",
    "panel.order": "Ordem",
    "panel.history": "Histórico",
    "panel.alerts": "Alertas",
    "panel.analytics": "Análise",
    "panel.settings": "Configurações",
    "panel.shortcuts": "Atalhos",
    "panel.assistant": "Assistente IA",
    "status.connected": "Conectado",
    "status.disconnected": "Desconectado",
    "status.connecting": "Conectando...",
    "action.buy": "Comprar",
    "action.sell": "Vender",
    "action.cancel": "Cancelar",
    "action.confirm": "Confirmar",
    "action.refresh": "Atualizar",
    "action.save": "Salvar",
    "action.close": "Fechar",
    "action.search": "Pesquisar",
    "table.volume": "Volume",
    "table.price": "Preço",
    "table.change": "Variação",
    "table.outcome": "Resultado",
    "table.size": "Tamanho",
    "table.value": "Valor",
    "table.pnl": "L/P",
    "error.generic": "Ocorreu um erro",
    "error.network": "Erro de rede",
    "error.auth": "Erro de autenticação",
    "success.saved": "Salvo com sucesso",
    "success.order": "Ordem executada",
    "confirm.cancel": "Tens a certeza?",
    "time.now": "Agora",
    "time.minutes": "há {n} minutos",
    "time.hours": "há {n} horas",
    "time.days": "há {n} dias",
  },
  zh: {
    "app.title": "Polymarket彭博终端",
    "nav.markets": "市场",
    "nav.portfolio": "投资组合",
    "nav.orders": "订单",
    "panel.wallet": "钱包",
    "panel.order": "订单",
    "panel.history": "历史",
    "panel.alerts": "警报",
    "panel.analytics": "分析",
    "panel.settings": "设置",
    "panel.shortcuts": "快捷键",
    "panel.assistant": "AI助手",
    "status.connected": "已连接",
    "status.disconnected": "已断开",
    "status.connecting": "连接中...",
    "action.buy": "买入",
    "action.sell": "卖出",
    "action.cancel": "取消",
    "action.confirm": "确认",
    "action.refresh": "刷新",
    "action.save": "保存",
    "action.close": "关闭",
    "action.search": "搜索",
    "table.volume": "成交量",
    "table.price": "价格",
    "table.change": "变化",
    "table.outcome": "结果",
    "table.size": "数量",
    "table.value": "价值",
    "table.pnl": "盈亏",
    "error.generic": "发生错误",
    "error.network": "网络错误",
    "error.auth": "认证错误",
    "success.saved": "保存成功",
    "success.order": "订单已下单",
    "confirm.cancel": "确定吗？",
    "time.now": "现在",
    "time.minutes": "{n}分钟前",
    "time.hours": "{n}小时前",
    "time.days": "{n}天前",
  },
  ja: {
    "app.title": "Polymarket Bloomberg TUI",
    "nav.markets": "マーケット",
    "nav.portfolio": "ポートフォリオ",
    "nav.orders": "注文",
    "panel.wallet": "ウォレット",
    "panel.order": "注文",
    "panel.history": "履歴",
    "panel.alerts": "アラート",
    "panel.analytics": "分析",
    "panel.settings": "設定",
    "panel.shortcuts": "ショートカット",
    "panel.assistant": "AIアシスタント",
    "status.connected": "接続済み",
    "status.disconnected": "切断",
    "status.connecting": "接続中...",
    "action.buy": "買い",
    "action.sell": "売り",
    "action.cancel": "キャンセル",
    "action.confirm": "確認",
    "action.refresh": "更新",
    "action.save": "保存",
    "action.close": "閉じる",
    "action.search": "検索",
    "table.volume": "出来高",
    "table.price": "価格",
    "table.change": "変動",
    "table.outcome": "結果",
    "table.size": "サイズ",
    "table.value": "価値",
    "table.pnl": "損益",
    "error.generic": "エラーが発生しました",
    "error.network": "ネットワークエラー",
    "error.auth": "認証エラー",
    "success.saved": "正常に保存されました",
    "success.order": "注文が成立しました",
    "confirm.cancel": "よろしいですか？",
    "time.now": "たった今",
    "time.minutes": "{n}分前",
    "time.hours": "{n}時間前",
    "time.days": "{n}日前",
  },
};

const DEFAULT_LANGUAGE: Language = "en";
let currentLanguage: Language = DEFAULT_LANGUAGE;

export function setLanguage(lang: Language): void {
  if (translations[lang]) {
    currentLanguage = lang;
  }
}

export function getLanguage(): Language {
  return currentLanguage;
}

export function t(key: string, params?: Record<string, string | number>): string {
  let text = translations[currentLanguage]?.[key] || translations[DEFAULT_LANGUAGE][key] || key;

  if (params) {
    for (const [param, value] of Object.entries(params)) {
      text = text.replace(`{${param}}`, String(value));
    }
  }

  return text;
}

export function getAvailableLanguages(): { code: Language; name: string }[] {
  return [
    { code: "en", name: "English" },
    { code: "es", name: "Español" },
    { code: "fr", name: "Français" },
    { code: "de", name: "Deutsch" },
    { code: "it", name: "Italiano" },
    { code: "pt", name: "Português" },
    { code: "zh", name: "中文" },
    { code: "ja", name: "日本語" },
  ];
}

export function detectSystemLanguage(): Language {
  if (typeof navigator !== "undefined") {
    const lang = navigator.language.split("-")[0] as Language;
    if (translations[lang]) {
      return lang;
    }
  }
  return DEFAULT_LANGUAGE;
}
